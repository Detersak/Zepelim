<div *ngIf="(estaLogado$ | async) === false" class="container d-flex justify-content-center align-items-center min-vh-100 bg-light">
  <div class="card border-0 shadow-lg" style="width: 400px;">
    
    <div class="card-header bg-dark text-white text-center py-4">
      <h4 class="fw-bold m-0 text-uppercase">Admin Zepelim</h4>
      <small class="text-white-50">Acesso Restrito</small>
    </div>
    
    <div class="card-body p-4">
      <div *ngIf="erroLogin" class="alert alert-danger text-center small fade show">
        <i class="bi bi-exclamation-circle-fill me-2"></i> Dados incorretos.
      </div>

      <form (submit)="fazerLogin()">
        <div class="mb-3">
          <label class="fw-bold small text-muted">Usuário</label>
          <input type="text" class="form-control" [(ngModel)]="usuario" name="user" placeholder="admin">
        </div>
        <div class="mb-4">
          <label class="fw-bold small text-muted">Senha</label>
          <input type="password" class="form-control" [(ngModel)]="senha" name="pass" placeholder="admin">
        </div>
        <button type="submit" class="btn btn-danger w-100 rounded-pill fw-bold shadow-sm">
          ENTRAR
        </button>
      </form>
    </div>
    
    <div class="card-footer bg-light text-center py-3 border-0">
      <small class="text-muted">Suporte: (61) 9999-9999</small>
    </div>
  </div>
</div>

<div *ngIf="(estaLogado$ | async) === true" class="container-fluid p-0">
  
  <header class="bg-white border-bottom p-3 d-flex justify-content-between align-items-center sticky-top shadow-sm" style="z-index: 1020;">
    <div class="fw-bold text-uppercase d-flex align-items-center text-dark">
      <i class="bi bi-shield-lock-fill text-danger me-2 fs-5"></i> Admin Zepelim
    </div>
    <div class="small">
      Usuário: <span class="fw-bold">Ricardo (Gerente)</span>
      <button class="btn btn-link text-danger text-decoration-none fw-bold ms-3 border border-danger rounded-pill px-3 py-1 btn-sm" (click)="sair()">
        <i class="bi bi-box-arrow-right me-1"></i> Sair
      </button>
    </div>
  </header>

  <div class="row g-0" style="min-height: calc(100vh - 70px);">
    
    <div class="col-md-3 col-lg-2 bg-white border-end p-3 d-none d-md-block">
      
      <h6 class="fw-bold text-uppercase text-muted mb-3 small pt-2">Menu Principal</h6>
      
      <div class="list-group list-group-flush mb-5">
        <a href="javascript:void(0)" class="list-group-item list-group-item-action border-0 px-2 fw-bold active rounded mb-1">
          <i class="bi bi-grid-fill me-2"></i> Visão Geral
        </a>
        <a href="javascript:void(0)" class="list-group-item list-group-item-action border-0 px-2 rounded mb-1 text-muted">
          <i class="bi bi-egg-fried me-2"></i> Cardápio / Produtos
        </a>
        <a href="javascript:void(0)" class="list-group-item list-group-item-action border-0 px-2 rounded mb-1 text-muted">
          <i class="bi bi-calendar-event me-2"></i> Agenda de Shows
        </a>
        <a href="javascript:void(0)" class="list-group-item list-group-item-action border-0 px-2 rounded mb-1 text-muted">
          <i class="bi bi-sliders me-2"></i> Configurações
        </a>
      </div>

      <h6 class="fw-bold text-uppercase text-muted mb-3 small">Acesso Rápido</h6>
      <div class="d-grid gap-2">
        <a href="/" target="_blank" class="btn btn-outline-dark btn-sm text-start border-0 bg-light">
          <i class="bi bi-box-arrow-up-right me-2"></i> Abrir Site (Cliente)
        </a>
        <a href="https://sympla.com.br" target="_blank" class="btn btn-outline-dark btn-sm text-start border-0 bg-light">
          <i class="bi bi-ticket-perforated me-2"></i> Abrir Sympla
        </a>
      </div>
    </div>

    <div class="col-md-9 col-lg-10 bg-light p-4">
      
      <div class="bg-white p-4 rounded shadow-sm mb-4 border">
        <div class="d-flex justify-content-between align-items-start border-bottom pb-3 mb-3">
          <div>
            <h5 class="fw-bold mb-1">1. Gestão Rápida de Cardápio</h5>
            <p class="text-muted small m-0">Pause produtos que acabaram na cozinha.</p>
          </div>
          <button class="btn btn-dark fw-bold text-nowrap rounded-pill px-4" (click)="novoProduto()">
            <i class="bi bi-plus-lg me-1"></i> Novo Produto
          </button>
        </div>

        <div class="mb-3 d-flex gap-2">
          <input type="text" class="form-control w-auto form-control-sm" placeholder="Buscar Produto...">
        </div>

        <div class="table-responsive">
          <table class="table table-hover align-middle">
            <thead class="bg-light text-uppercase small">
              <tr>
                <th class="ps-3">Produto</th>
                <th>Categoria</th>
                <th>Preço</th>
                <th>Status (Estoque)</th>
                <th class="text-end pe-3">Ações</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let prod of produtos$ | async">
                <td class="ps-3">
                  <div class="d-flex align-items-center">
                    <img [src]="prod.imagemUrl" class="rounded me-3 object-fit-cover bg-secondary" width="40" height="40" 
                         [class.opacity-50]="!prod.disponivel">
                    <div class="fw-bold" [class.text-muted]="!prod.disponivel">{{ prod.nome }}</div>
                  </div>
                </td>
                <td><span class="badge bg-light text-dark border fw-normal">{{ prod.categoria }}</span></td>
                <td class="font-monospace text-muted">{{ prod.preco | currency:'BRL' }}</td>
                
                <td>
                  <div class="d-flex align-items-center">
                    <span *ngIf="prod.disponivel" class="badge bg-success-subtle text-success border border-success me-3" style="width: 80px;">Ativo</span>
                    <span *ngIf="!prod.disponivel" class="badge bg-danger-subtle text-danger border border-danger me-3" style="width: 80px;">PAUSADO</span>

                    <div class="form-check form-switch m-0">
                      <input class="form-check-input cursor-pointer" type="checkbox" role="switch"
                             style="width: 3em; height: 1.5em;"
                             [checked]="prod.disponivel"
                             (change)="alternarDisponibilidade(prod)">
                    </div>
                  </div>
                </td>

                <td class="text-end pe-3">
                  <div class="btn-group">
                    <button class="btn btn-sm btn-outline-secondary fw-bold" (click)="editarProduto(prod)">Editar</button>
                    <button class="btn btn-sm btn-outline-danger" (click)="removerProduto(prod)">
                      <i class="bi bi-trash-fill"></i>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="bg-white p-4 rounded shadow-sm border">
        <div class="d-flex justify-content-between align-items-start border-bottom pb-3 mb-3">
          <div>
            <h5 class="fw-bold mb-1">2. Próximos Eventos (Agenda)</h5>
            <p class="text-muted small m-0">Links do Sympla cadastrados.</p>
          </div>
        </div>

        <div class="table-responsive mb-3">
          <table class="table table-hover align-middle">
            <thead class="bg-light text-uppercase small">
              <tr>
                <th class="ps-3">Data</th>
                <th>Atração</th>
                <th>Link Venda</th>
                <th>Status</th>
                <th class="text-end pe-3">Ações</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let evento of eventos$ | async">
                <td class="ps-3">
                  <div class="fw-bold">{{ evento.data | date:'dd/MM' }}</div>
                  <div class="small text-muted">{{ evento.data | date:'HH:mm' }}h</div>
                </td>
                <td class="fw-bold">{{ evento.titulo }}</td>
                
                <td class="small text-muted text-truncate" style="max-width: 150px;">
                  <a [href]="evento.linkIngresso" target="_blank" class="text-decoration-none" *ngIf="evento.linkIngresso">
                    <i class="bi bi-link-45deg"></i> Link Sympla
                  </a>
                  <span *ngIf="!evento.linkIngresso" class="text-muted fst-italic">--</span>
                </td>

                <td>
                  <span *ngIf="evento.status !== 'lotado'" class="text-success small fw-bold">
                    <i class="bi bi-check-circle-fill me-1"></i> Publicado
                  </span>
                  <span *ngIf="evento.status === 'lotado'" class="text-danger small fw-bold">
                    <i class="bi bi-x-circle-fill me-1"></i> Esgotado
                  </span>
                </td>

                <td class="text-end pe-3">
                   <div class="btn-group">
                     <button class="btn btn-sm btn-outline-secondary fw-bold" (click)="editarEvento(evento)">Editar</button>
                     <button class="btn btn-sm btn-outline-danger fw-bold" (click)="removerEvento(evento)">X</button>
                   </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <button class="btn btn-outline-dark fw-bold w-100 py-2 border-2 border-dashed" (click)="novoEvento()">
          <i class="bi bi-plus-circle me-2"></i> Adicionar Novo Show
        </button>

      </div>

    </div>
  </div>
</div>